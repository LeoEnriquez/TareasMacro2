knitr::opts_chunk$set(echo = F, fig.width = 6, fig.height = 3.5)
rm(list = ls())
pacman::p_load(tidyverse,
kableExtra,
ggplot2,
cowplot,
stargazer,knitr,viridis,dplyr,readr,scales,quantmod,texreg,tinytex, tidyr, imager,lubridate,tseries, astsa, growthrates, tis, dynlm, readxl )
imagen1 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/Problema%208.1.png")
plot(imagen1, main = "Figura 1. Ahorro en el ciclo de vida", axes = FALSE)
Yp2_i <- rnorm(20, 10, 2)
Yp2 <- matrix(0, nrow = 100, ncol = 20)
for (i in 1:20){
Yp2[,i] <- Yp2_i[i]
}
colnames(Yp2) <- c(paste0(1:20))
rownames(Yp2) <- c(1:100)
GrafIngPerm <- barplot (Yp2[1,], col = "blue", ylim = c(0, 20), main = "Gráfica 2.1. Ingreso permanente de 20 individuos", xlab = "Individuos", ylab = "Ingreso permanente en miles de pesos", cex.names = .7)
abline(h = mean(Yp2[1,]), col ="red", legend("topright", "Media", fill = "red"))
Yt2 <- matrix( rnorm(100*20, mean = 0, sd = 2), 100, 20)
colnames(Yt2) <- c(paste0(1:20))
rownames(Yt2) <- c(1:100)
GrafIngTrans1 <- barplot (Yt2[1,], col = "green", ylim = c(-7, 7), main = "Gráfica 2.2. Un ingreso transitorio de 20 individuos", xlab = "Individuos", ylab = "Ingreso transitorio en miles de pesos", cex.names = 0.7)
abline(h = mean(Yt2[1,]), col ="red", legend("topright", "Media", fill = "red"))
GrafIngTrans2 <- barplot (Yt2[,1], col = "green", ylim = c(-7, 7), main = "Gráfica 2.3. 100 Ingresos transitorios para el individuo 1", xlab = "Ingresos transitorios aleatorios", ylab = "Miles de pesos", cex.names = 0.7)
abline(h = mean(Yt2[,1]), col ="red", legend("topright", "Media", fill = "red"))
Y2 <- Yp2 + Yt2
GrafIngTotal1 <- barplot (Y2[1,], col = "purple", ylim = c(0, 20), main = "Gráfica 2.4. Un ingreso total de 20 individuos", xlab = "Individuos", ylab = "Ingreso total en miles de pesos", cex.names = 0.7)
abline(h = mean(Y2[1,]), col ="red", legend("topright", "Media", fill = "red"))
GrafIngTotal2 <- barplot (Y2[,1], col = "purple", ylim = c(0, 20), main = "Gráfica 2.5. 100 ingresos totales para el individuo 1", xlab = "Ingresos totales", ylab = "Miles de pesos", cex.names = 0.7)
abline(h = mean(Y2[,1]), col ="red", legend("topright", "Media", fill = "red"))
et2 <- matrix( rnorm(100*20, mean = 0, sd = 0.5), 100, 20)
colnames(et2) <- c(paste0(1:20))
rownames(et2) <- c(paste0(1:100))
GrafError1 <- barplot (et2[1,], col = "red", ylim = c(-2, 2), main = "Gráfica 2.6. Un error de medición de 20 individuos", xlab = "Individuos", ylab = "Error promedio de medición en miles de pesos", cex.names = 0.7)
abline(h = mean(et2[1,]), col ="yellow", legend("topright", "Media", fill = "yellow"))
GrafError1 <- barplot (et2[,1], col = "red", ylim = c(-2.5, 2.5), main = "Gráfica 2.7. 100 errores de medición para el individuo 1", xlab = "Errores aleatorios", ylab = "Miles de pesos", cex.names = 0.7)
abline(h = mean(et2[,1]), col ="yellow", legend("topright", "Media", fill = "yellow"))
Ct2 <- Yp2 + 0.1*(Yt2) + et2
barplot (Ct2[1,], col = "#00FFFF", ylim = c(0, 20), main = "Gráfica 2.8. Un consumo de 20 individuos", xlab = "Individuos", ylab = "Consumo promedio en miles de pesos", cex.names = 0.7)
abline(h = mean(Ct2[1,]), col ="red", legend("topright", "Media", fill = "red"))
barplot (Ct2[,1], col = "#00FFFF", ylim = c(0, 20), main = "Gráfica 2.9. 100 consumos para el individuo 1", xlab = "Individuos", ylab = "Consumo promedio en miles de pesos", cex.names = 0.7)
abline(h = mean(Ct2[,1]), col ="red", legend("topright", "Media", fill = "red"))
scatter.smooth(x = Y2, y = Ct2, span = 1, main = "Gráfica 2.10. Relación entre el Consumo y el Ingreso", xlab = "Ingreso", ylab = "Consumo", col = "#333399", cex = 0.5)
for (i in 1:20) {
rr <- paste("reg", i, sep = "_")
reg_full<-assign(rr, lm(Ct2[,i] ~ Y2[,i]))
}
#Tabla mejorada
stargazer(reg_1, reg_2, reg_3, reg_4, reg_5,reg_6, reg_7, reg_8, reg_9, reg_10,
title= "Tabla de Regresión 1",
column.labels = c("1","2","3","4","5","6","7","8","9","10"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
###
stargazer(reg_11, reg_12, reg_13, reg_14, reg_15, reg_16, reg_17, reg_18, reg_19, reg_20,
title= "Tabla de Regresión 1 (Continuación)",
column.labels = c("11","12","13","14","15","16","17","18","19","20"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso","Constante"),
#omit.stat = c("ll","rsq"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
NYp2_i <- rnorm(20, mean = 10, sd = 3)
NYp2 <- matrix(0, nrow = 100, ncol = 20)
for (i in 1:20){
NYp2[,i] <- NYp2_i[i]
}
colnames(NYp2) <- c(paste0(1:20))
rownames(NYp2) <- c(1:100)
NYt2 <- matrix( rnorm(100*20, mean = 0, sd = 0.5), 100, 20)
colnames(NYt2) <- c(paste0(1:20))
NY2 <- NYp2 + NYt2
NCt2 <- NYp2 + 0.1*(NYt2) + et2
scatter.smooth(x = NY2, y = NCt2, span = 1, main = "Gráfica 2.11. Relación entre el Consumo y el Ingreso.\n Varianza del ingreso permanente más alta y varianza del ingreso transitorio más baja.", xlab = "Ingreso", ylab = "Consumo", col = "#333399", cex = 0.5, cex.main = 0.7)
for (i in 1:20) {
nrr <- paste("nreg", i, sep = "_")
nreg_full<-assign(nrr, lm(NCt2[,i] ~ NY2[,i]))
}
#Tabla mejorada
stargazer(nreg_1, nreg_2, nreg_3, nreg_4, nreg_5,nreg_6, nreg_7, nreg_8, nreg_9, nreg_10,
title= "Tabla de Regresión 2",
column.labels = c("1","2","3","4","5","6","7","8","9","10"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
###
stargazer(nreg_11, nreg_12, nreg_13, nreg_14, nreg_15, nreg_16, nreg_17, nreg_18, nreg_19, nreg_20,
title= "Tabla de Regresión 2 (Continuación)",
column.labels = c("11","12","13","14","15","16","17","18","19","20"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso","Constante"),
#omit.stat = c("ll","rsq"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
NNYp2_i <- rnorm(20, mean = 10, sd = 0.5)
NNYp2 <- matrix(0, nrow = 100, ncol = 20)
for (i in 1:20){
NNYp2[,i] <- NNYp2_i[i]
}
colnames(NNYp2) <- c(paste0(1:20))
rownames(NNYp2) <- c(1:100)
NNYt2 <- matrix( rnorm(100*20, mean = 0, sd = 3), 100, 20)
colnames(NNYt2) <- c(paste0(1:20))
NNY2 <- NNYp2 + NNYt2
NNCt2 <- NNYp2 + 0.1*(NNYt2) + et2
reg3 <- scatter.smooth(x = NNY2, y = NNCt2, span = 1, main = "Gráfica 2.12. Relación entre el Consumo y el Ingreso.\n Varianza del ingreso permanente más alta y varianza del ingreso transitorio más baja.", xlab = "Ingreso", ylab = "Consumo", col = "#333399", cex = 0.5, cex.main = 0.7)
for (i in 1:20) {
nnrr <- paste("nnreg", i, sep = "_")
nnreg_full<-assign(nnrr, lm(NNCt2[,i] ~ NNY2[,i]))
}
#Tabla mejorada
stargazer(nnreg_1, nnreg_2, nnreg_3, nnreg_4, nnreg_5,nnreg_6, nnreg_7, nnreg_8, nnreg_9, nnreg_10,
title= "Tabla de Regresión 3",
column.labels = c("1","2","3","4","5","6","7","8","9","10"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso", "Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
###
stargazer(nnreg_11, nnreg_12, nnreg_13, nnreg_14, nnreg_15, nnreg_16, nnreg_17, nnreg_18, nnreg_19, nnreg_20,
title= "Tabla de Regresión 3 (Continuación)",
column.labels = c("11","12","13","14","15","16","17","18","19","20"),
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Consumo",
covariate.labels = c("Ingreso","Constante"),
#omit.stat = c("ll","rsq"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
#h", "t","b", "p", "!", "H"
datosej3 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/datos_ejercicio3.csv")
imagen2 <- load.image("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/summary.PNG")
plot(imagen2, main = "Cuadro 3.1. Estadísticas descriptivas \n de las variables macroeconómicas de México", axes = FALSE)
serie1 <- ts(datosej3, start=1980, frequency = 4)
C3<-serie1[ ,1]
G3<-serie1[ ,2]
I3<-serie1[ ,3]
XN3<-serie1[ ,4]
Y3<-serie1[ ,5]
ts.plot (C3,G3,I3,XN3,Y3, gpars=list(xlab="Trimestres", ylab="Miles de millones de pesos (2013=100)", main="Gráfica 3.1. Trayectoria de variables \n macroeconómicas de la economía Mexicana", col=5:1, lwd=2))
legend ('topleft', col=5:1,lwd=5, legend=c("Consumo","Gasto público","Inversión","Exportaciones netas","PIB"), bg='white', bty="n", cex = 0.5)
###Creo nuevas variables. Logaritmo de gasto privado, del gobierno, inversión, exportaciones netas e ingreso.
lnC3 <- log(C3, base=exp(1))
lnG3 <- log(G3, base=exp(1))
lnI3 <- log(I3, base=exp(1))
lnXN3 <- log(XN3, base=exp(1))
lnY3 <- log(Y3, base=exp(1))
###grafica de las series de tiempo en logaritmos. Nota: no se grafica el logaritmo natural de XN porque hay valores negativos
ts.plot (lnC3,lnG3,lnI3,lnY3, gpars=list(xlab="Trimestres", ylab="Logaritmo natural", main="Gráfica 3.2. Trayectoria de variables macroeconómicas \n de la economía Mexicana en logaritmos", col=4:1, lwd=2))
legend ('topleft', col=4:1,lwd=5, legend=c("lnc","lnG","lnI","lnY"), bg='white', bty="n", cex = 0.5, par(mar = c(5, 5, 4, 6)))
crecY3 <- growth.rate(Y3, lag=4)
ts.plot (crecY3,   xlab="Trimestres", ylab="Tasa de crecimiento", main="Gráfica 3.3. Tasa de crecimiento del ingreso", lwd=2)
crecC3 <- growth.rate(C3, lag=4)
ts.plot (crecC3,   xlab="Trimestres", ylab="Porcentaje", main="Gráfica 3.4. Tasa de crecimiento del Consumo", col="cyan", lwd=3)
crecG3 <- growth.rate(G3, lag=4)
ts.plot (crecG3,   xlab="Trimestres", ylab="Porcentaje", main="Gráfica 3.5. Tasa de crecimiento del gasto público", col="blue", lwd=3)
crecI3 <- growth.rate(I3, lag=4)
ts.plot (crecI3,   xlab="Trimestres", ylab="Porcentaje", main="Gráfica 3.6. Tasa de la inversión", col="green3", lwd=3)
crecXN3 <- growth.rate(XN3, lag=4)
ts.plot (crecXN3,   xlab="Trimestres", ylab="Porcentaje", main="Gráfica 3.7. Tasa de crecimiento de las exportaciones netas", col="red", lwd=3)
scatter.smooth(x=crecY3, y=crecC3, span = 1, xlab="Tasa de crecimiento del ingreso", ylab="Tasa de crecimiento del consumo", main="Grafica 3.8. Relación entre los cambios porcentuales \n del consumo y el ingreso ", col="magenta", lwd=2, cex=0.5, cex.main = 0.9)
sdY3<- sd(crecY3)
sdC3<- sd(crecC3)
sdY3
sdC3
A3 <- crecY3-mean(crecY3)
B3 <- crecC3-mean(crecC3)
#A es variación del ingreso respecto de su media
#B es variación del consumo respecto de su media
A3<- ts(A3, start=1980, frequency = 4)
B3<- ts(B3, start=1980, frequency = 4)
ts.plot (A3,B3, gpars=list(xlab="Trimestres", ylab="Variación respecto de la media", main=" Gráfica 3.9. Variación del PIB \n y del Consumo, respecto a sus medias", col=c("blue","red"),lwd= 2, cex.main=0.9))
legend ('bottom', col=c("blue","red"),lwd=3, legend=c("PIB","Consumo"), bg='white',bty="n",cex=0.7)
reg21 <- lm(C3 ~ Y3)
scatter.smooth(x = Y3, y = C3, span = 1, main = "Gráfica 3.10. Relación entre Consumo y PIB", xlab = "PIB", ylab = "Consumo", col = "#333399", cex = 0.5, lwd=3)
reg22 <- lm(crecC3 ~ crecY3)
scatter.smooth(x = crecY3, y = crecC3, span = 1, main = "Gráfica 3.11. Relación entre las tasas de crecimiento \n del  Consumo y del PIB", xlab = "Var.% PIB", ylab = "Var.% Consumo", col = "#333399", cex = 0.5, lwd=3)
Yr3<- Lag(crecY3, k= 1)
reg23 <- dynlm(crecC3 ~ L(crecY3,1))
scatter.smooth(x = Yr3, y = crecC3, span = 1, main = "Gráfica 3.12. Relación entre variación % del PBI \n rezagado y la variación % del consumo", xlab = "Var.% PBI-1", ylab = "Var.% C", col = "#333399", cex = 0.5, lwd=3)
reg24 <- lm(lnC3 ~ lnY3)
scatter.smooth(x = lnY3, y = lnC3, span = 1, main = "Gráfica 3.13. Relación entre \n el logaritmo del Consumo y el logaritmo del PIB", xlab = "Log PIB", ylab = "Log Consumo", col = "#333399", cex = 0.5, lwd=3)
stargazer(reg21, reg22, reg23, reg24 ,
title= "Tabla de Regresión 4. Consumo e Ingreso.",
header = FALSE,
font.size = "scriptsize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = c("C", "tcC", "crecC, logC"),
covariate.labels = c("Y", "tcY", "crecY", "logY"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
enigh2016_1 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/enigh2016_1_ejercicio4.csv")
enigh2016_1 <- as.matrix(enigh2016_1)
summary(enigh2016_1)
enigh2016_1 <- subset(enigh2016_1, enigh2016_1[,1] < 1000)
enigh2016_1 <- subset(enigh2016_1, enigh2016_1[,2] < 500)
scatter.smooth(enigh2016_1[,1], enigh2016_1[,2] , span = 1, main = "Gráfica 4.1. Relación entre el Gasto y el Ingreso trimestral por hogar, 2016", xlab = "Ingreso en miles de pesos", ylab = "Gasto en miles de pesos", col = "#333399", cex = 0.5, cex.main = 0.9)
regIG <- lm(enigh2016_1[,1] ~ enigh2016_1[,2])
stargazer(regIG,
title= "Tabla de Regresión 5. Ingreso y Gasto trimestral, 2016",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Gasto",
covariate.labels = c("Ingreso","Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
enigh2016_2 <- read_csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/enigh2016_2_ejercicio4.csv")
enigh2016_2 <- as.matrix(enigh2016_2)
enigh2016_2 <- subset(enigh2016_2, enigh2016_2[,1] < 1000)
enigh2016_2 <- subset(enigh2016_2, enigh2016_2[,2] < 500)
scatter.smooth(enigh2016_2[,1], enigh2016_2[,2] , span = 5, main = "Gráfica 4.2. Relación entre el Gasto y el Ingreso trimestral por hogar. \n Hogares unipersonales y nucleares de 40 a 50 años, en la Ciudad de México", xlab = "Ingreso en miles de pesos", ylab = "Gasto en miles de pesos", col = "#333399", cex = 0.5, cex.main = 0.9)
regIG2 <- lm(enigh2016_2[,1] ~ enigh2016_2[,2])
stargazer(regIG2,
title= "Tabla de Regresión 6. Ingreso y Gasto trimestral, 2016",
header = FALSE,
font.size = "footnotesize",
dep.var.caption = "Variable Dependiente",
dep.var.labels = "Gasto",
covariate.labels = c("Ingreso","Constante"),
notes.label = "P-valor",
type="latex",
table.placement = "!htbp")
enigh2016_3 <- read.csv("https://raw.githubusercontent.com/LeoEnriquez/TareasMacro2/Tarea-1/Datos%20Tarea%201/enigh2016_3_ejercicio4.csv", row.names=1)
barplot (enigh2016_3[,1], names.arg= row.names(enigh2016_3), las =2, col = "magenta", ylim = c(0, 45), main = "Gráfica 4.3. Ingreso promedio trimestral en miles de pesos.\n Hogares unipersonales", xlab = "Grupos de edad", ylab = "Ingreso promedio", cex.names = .7, cex.main = 0.9)
abline(h = mean(enigh2016_3[,1]), col ="red", legend("topright", "Media", fill = "red"))
barplot (enigh2016_3[,2], names.arg= row.names(enigh2016_3), col = "cyan", las = 2, ylim = c(0, 35), main = "Gráfica 4.4. Gasto promedio trimestral en miles de pesos. \n Hogares unipersonales", xlab = "Grupos de edad", ylab = "Gasto promedio", cex.names = .7, cex.main = 0.9)
abline(h = mean(enigh2016_3[,2]), col ="red", legend("topright", "Media", fill = "red"))
